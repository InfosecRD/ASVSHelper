<html>
<head>
<title>ASVS Helper</title>
<script>

var reader = new XMLHttpRequest();

function read(file) {
   reader.open('GET', 'https://raw.githubusercontent.com/Ryan2Delaney2/ASVSHelper/master/' + file);
   reader.onreadystatechange = function() {
      document.getElementById('infobox').value = reader.responseText;
   }
   reader.send();
}

data = [
["Is this an application?",["v1.1","v1.2","v1.3","v1.4","v1.9","v1.11"],0],
["Does your application use external components?",["v1.5","v19.8","v19.10"],0],
["Does your application face threats?",["v1.6"],0],
["Does your application need security controls?",["v1.7","v1.8","v1.9","v2.19","v4.11","v10.8","v16.7","v19.6"],0],
["Does your application have an administrative interface?",["v2.32","v18.2","v19.6"],0],
["Does your application perform any form of authentication?",["v2.1","v2.8","v19.3"],0],
["Does your application store any data?",["v2.2"],0],
["Does your application perform any form of authentication? (We know we asked this before) ",["v2.4","v2.6","v2.18","v10.6"],0],
["Do your users ever enter passwords?",["v2.7","v2.27"],0],
["Do your users ever change passwords?",["v2.9","v2.25"],0],
["Does your application store passwords?",["v2.13","v2.19","v2.29","v7.13"],0],
["Does your application use any secret questions?",["v2.24"],0],
["Does your application allow 2FA?",["v2.26","v2.31","v4.15"],0],
["Does your application allow users to log out?",["v3.5"],0],
["Does your application use any keys?",["v7.9","v7.11","7.14"],0],
["Does your mobile application use any keys?",["v17.4"],0],
["Is this a mobile app?",["v17.1"],0],
["Y'all got any of them web services?",["v18.6"],0],
["You need to be logging stuff. Click yes.",["v2.12","v4.12","v5.3","v8.3","v8.4","v8.7","v8.9","9.1","v10.4"],0],
["And those logs will probably have files, I reckon?",["v8.6","v8.10","v8.11","v8.12","v8.13"],0],
["Encryption? If your response is \"Of course, base64\", just get out now.",["v2.16","v7.7","v7.8","v10.13","v10.15","v19.2"],0],
["Do you digitally sign stuff?",["v19.7"],0],
["Does your application let users recover their passwords?",["v2.17","v2.22"],0],
["Your app should lock out numerous login attempts. Click yes.",["v2.23"],0],
["Permissions? ",["v17.6"],0],
["You need to lock out bad guys?",["v4.1","v4.4","v4.8","v4.14"],0],
["Should we look at lock out logic?",["v4.10"],0],
["Brute force prevention. You almost certainly want this.",["v2.20"],0],
["r u storin' muh passwords?",["v2.21"],0],
["Coding practices. Click yes, you're a coder for f&%k's sake.",["v5.24","v5.25","v13.2","v19.9"],0],
["I hereby agree to not store credentials in my code.",["v2.29"],0],
["But do you store stuff in client side memory?",["v5.26","v7.13","v9.6","v9.9","v9.11"],0],
["Client side PHONE memory?!?!",["v17.3","v17.5","v17.10"],0],
["Do you do any memory allocation?",["v9.5","v13.1"],0],
["Do you do any PHONE memory allocation?",["v17.2","v17.7","v17.9"],0],
["If your app has a browser, click yes.",["v2.33"],0],
["Does your app have sessions?",["v3.1","v3.2","v3.6","v3.7","v3.10","v3.11","v3.16","v3.17","v3.18"],0],
["Does your app have sessions p2: electric boogaloo?",["v3.3","v3.4"],0],
["Randomization. Need it?",["v3.11","v7.6","v7.15"],0],
["Cookies. Use em?",["v3.12"],0],
["User Interface. Yes if you have users.",["v3.17","v3.18","v5.23","v9.1"],0],
["User Experience? It's important.",["v4.9","v5.18"],0],
["File Structure. Good if you use files.",["v4.5","v16.6","v19.4"],0],
["Cross-Site Request Forgery (CSRF). Good if you do stuff.",["v4.13","v18.7"],0],
["User Enumeration/ Click yes.",["v2.18","v2.28"],0],
["Parameter Tampering Click yes please.",["v4.16"],0],
["Buffer Overflows Click yes pretty please.",["v5.1"],0],
["Does your app use SQL?",["v5.10"],0],
["Does your app use LDAP?",["v5.11"],0],
["Does your app use exec()?",["v5.12","v8.5"],0],
["File Inclusion stuff, hit yes.",["v5.13","v16.4"],0],
["Got XML?",["v5.14"],0],
["XSS stuff just click yes.",["v5.15"],0],
["Parameter Binding. yes.",["v5.16"],0],
["HTTP Parameter Pollution. Yes if you use HTTP.",["v5.17"],0],
["Oracle Padding. Roll your own crypto lately?",["v7.2"],0],
["Data harvesting/scraping. This is bad, click yes.",["v9.8"],0],
["Debigging... wait a second... John, what the hell is Debigging?",["v17.8"],0],
["Input Validation. Yes if there's any input.",["v5.3","v5.5","v5.6","v5.18","v5.19","v5.20","v5.21","v5.22","v8.5","v8.8","v16.2","v16.3","v16.4","v16.8","v17.11","v18.4"],0],
["Error Handling. Yes if you ever have errors.",["v7.2","v8.1","v8.2"],0],
["Personally Identifiable Information (PII). Got PII?",["v7.12","v17.3"],0],
["Sensitive Data Control Policies. Have any sensitive data?",["v9.2","v9.3","v9.6"],0],
["Headers, got any?",["v9.4","v10.11","v11.2","v11.3","v11.4","v11.5","v11.6","v11.7","v11.8","v18.1","v18.8"],0],
["Parameters, hit yes.",["v9.7"],0],
["Request Types, oh yeah, hit yes.",["v11.1"],0],
["TLS Certificates. If you hit no we're not friends anymore.",["v10.1","v10.3","v10.5","v10.8","v10.10","v10.14","v10.16"],0],
["URL Whitelisting. You better hit yes.",["v10.12","v16.1"],0],
["Anti-Automation. You want this.",["v9.8","v15.1","v15.2"],0],
["Cross-Domain Resource Sharing (CORS). Helpful.",["v16.5"],0],
["Mobile Screenshotting. This is a mobile app, right...?",["v17.5"],0],
["Encoding. Yes.",["v18.1"],0],
["Input Schema. Sure.",["v18.3"],0],
["SOAP Services, whatever floats your boat.",["v18.5","v18.9"],0],
["REST Services. get some sleep.",["v18.7","v18.8"],0],
["Access Paths yes",["v18.10"],0],
["Software Configurations. Done any?",["v19.1"],0],
["Build Process, just click yes this is the last one.",["v19.5"],0]
];

mq = data.length - 1;
cq = mq - data.length;

function yes() {
   data[cq][2] = 1;
   next();
}

function next() {
   if (cq < mq) {
      cq += 1;
      document.getElementById("question").innerHTML = data[cq][0];
   } else {      
      document.getElementById("question").innerHTML = "Results:<br>";
      document.getElementById("yesB").remove();
      document.getElementById("noB").remove();
      document.getElementById("infobox").style.display = "block";   
      for (x = 0; x <= mq; x++) {
         if (data[x][2] == 1) {
            for (y = 0; y < data[x][1].length; y++) {
               document.getElementById("output").innerHTML += '<a href="' + data[x][1][y] + '" onmouseover=\"read(\'' + data[x][1][y] + '\');">' + data[x][1][y] + '</a><br>';
            }
         }
      }
   }
}

</script>
</head>
<body onload="next();" style="background-size:100% 100%;background-image:url('http://yesofcorsa.com/wp-content/uploads/2017/02/4K-Beach-Wallpaper-Free.jpg');">
<div style="margin:auto;">
   <h1 id="question" style="text-align:center;background-color:black;color:white;width:20%;margin-left:auto;margin-right:auto;"></h1>
   <br>
   <div style="margin:auto;margin-left:auto;margin-right:auto;">
      <div style="margin;auto;width:20%;margin-left:auto;margin-right:auto;">
         <button id="yesB" onclick="yes();" style="height:100px;width:100px;float:left;font-size:3em;background-color:green;">Yes</button>
         <button id="noB" onclick="next();" style="height:100px;width:100px;float:right;font-size:3em;background-color:red;">No</button>
      </div>
      <br>
      <div style="margin:auto;width:50%;float:left;">
            <textarea id="infobox" rows="30" cols="90" style="display:none;"></textarea>
      </div>
      <div style="margin:auto;width:50%;float:right;">
         <label id="output" style="background-color:white;color:black;"></label>
      </div>
   </div>
</div>
</body>
</html>
