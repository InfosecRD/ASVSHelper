<html>
<head>
<title>ASVS Helper</title>
<script>

var reader = new XMLHttpRequest();

function read(file) {
   reader.open('GET', 'https://raw.githubusercontent.com/Ryan2Delaney2/ASVSHelper/master/' + file);
   reader.onreadystatechange = function() {
      document.getElementById('infobox').value = reader.responseText;
   }
   reader.send();
}

data = [
["Artchitecture - Identifying Components",["v1.1","v1.2","v1.3","v1.4","v1.9","v1.11"],0],
["External Components",["v1.5","v19.8","v19.10"],0],
["Threat Modeling",["v1.6"],0],
["Security Controls",["v1.7","v1.8","v1.9","v2.19","v4.11","v10.8","v16.7","v19.6"],0],
["Administrative Access",["v2.32","v18.2","v19.6"],0],
["Authentication",["v2.1","v2.8","v19.3"],0],
["Storage",["v2.2"],0],
["Authentication Controls",["v2.4","v2.6","v2.18","v10.6"],0],
["Password Entry",["v2.7","v2.27"],0],
["Password Change",["v2.9","v2.25"],0],
["Password Storage",["v2.13","v2.19","v2.29","v7.13"],0],
["Secret Questions",["v2.24"],0],
["Multi-Factor Authentication",["v2.26","v2.31","v4.15"],0],
["Logout",["v3.5"],0],
["Key Management",["v7.9","v7.11","7.14"],0],
["Key Management (Mobile)",["v17.4"],0],
["Mobile Devices",["v17.1"],0],
["Web Services",["v18.6"],0],
["Logging - What Informaton Gets Logged",["v2.12","v4.12","v5.3","v8.3","v8.4","v8.7","v8.9","9.1","v10.4"],0],
["Log Files",["v8.6","v8.10","v8.11","v8.12","v8.13"],0],
["Encryption",["v2.16","v7.7","v7.8","v10.13","v10.15","v19.2"],0],
["Digital Signing",["v19.7"],0],
["Password Recovery",["v2.17","v2.22"],0],
["Lockout",["v2.23"],0],
["Permissions",["v17.6"],0],
["Access Management",["v4.1","v4.4","v4.8","v4.14"],0],
["Access Control Logic",["v4.10"],0],
["Brute Force Attack Prevention",["v2.20"],0],
["Storage of Credentials",["v2.21"],0],
["Coding Practices",["v5.24","v5.25","v13.2","v19.9"],0],
["Storing Credentials in Code",["v2.29"],0],
["Client-Side Memory",["v5.26","v7.13","v9.6","v9.9","v9.11"],0],
["Client-Side Memory (Mobile)",["v17.3","v17.5","v17.10"],0],
["Memory Allocation",["v9.5","v13.1"],0],
["Memory Allocation (Mobile)",["v17.2","v17.7","v17.9"],0],
["Browser Capabilities",["v2.33"],0],
["Session Management",["v3.1","v3.2","v3.6","v3.7","v3.10","v3.11","v3.16","v3.17","v3.18"],0],
["Timeout",["v3.3","v3.4"],0],
["Randomization",["v3.11","v7.6","v7.15"],0],
["Cookies",["v3.12"],0],
["User Interface",["v3.17","v3.18","v5.23","v9.1"],0],
["User Experience",["v4.9","v5.18"],0],
["File Structure",["v4.5","v16.6","v19.4"],0],
["Cross-Site Request Forgery (CSRF)",["v4.13","v18.7"],0],
["User Enumeration",["v2.18","v2.28"],0],
["Parameter Tampering",["v4.16"],0],
["Buffer Overflows",["v5.1"],0],
["SQL Injection",["v5.10"],0],
["LDAP Injection",["v5.11"],0],
["OS Command Injection",["v5.12","v8.5"],0],
["File Inclusion",["v5.13","v16.4"],0],
["XML Attacks",["v5.14"],0],
["XSS",["v5.15"],0],
["Parameter Binding",["v5.16"],0],
["HTTP Parameter Pollution",["v5.17"],0],
["Oracle Padding",["v7.2"],0],
["Data harvesting/scraping",["v9.8"],0],
["Debigging",["v17.8"],0],
["Input Validation",["v5.3","v5.5","v5.6","v5.18","v5.19","v5.20","v5.21","v5.22","v8.5","v8.8","v16.2","v16.3","v16.4","v16.8","v17.11","v18.4"],0],
["Error Handling",["v7.2","v8.1","v8.2"],0],
["Personally Identifiable Information (PII)",["v7.12","v17.3"],0],
["Sensitive Data Control Policies",["v9.2","v9.3","v9.6"],0],
["Headers",["v9.4","v10.11","v11.2","v11.3","v11.4","v11.5","v11.6","v11.7","v11.8","v18.1","v18.8"],0],
["Parameters",["v9.7"],0],
["Request Types",["v11.1"],0],
["TLS Certificates",["v10.1","v10.3","v10.5","v10.8","v10.10","v10.14","v10.16"],0],
["URL Whitelisting",["v10.12","v16.1"],0],
["Anti-Automation",["v9.8","v15.1","v15.2"],0],
["Cross-Domain Resource Sharing (CORS)",["v16.5"],0],
["Mobile Screenshotting",["v17.5"],0],
["Encoding",["v18.1"],0],
["Input Schema",["v18.3"],0],
["SOAP Services",["v18.5","v18.9"],0],
["REST Services",["v18.7","v18.8"],0],
["Access Paths",["v18.10"],0],
["Software Configurations",["v19.1"],0],
["Build Process",["v19.5"],0]
];

mq = data.length - 1;
cq = mq - data.length;

function yes() {
   data[cq][2] = 1;
   next();
}

function next() {
   if (cq < mq) {
      cq += 1;
      document.getElementById("question").innerHTML = data[cq][0];
   } else {      
      document.getElementById("question").innerHTML = "Results:<br>";
      document.getElementById("yesB").remove();
      document.getElementById("noB").remove();
      document.getElementById("infobox").style.display = "block";   
      for (x = 0; x <= mq; x++) {
         if (data[x][2] == 1) {
            for (y = 0; y < data[x][1].length; y++) {
               document.getElementById("output").innerHTML += '<a href="' + data[x][1][y] + '" onmouseover=\"read(\'' + data[x][1][y] + '\');">' + data[x][1][y] + '</a><br>';
            }
         }
      }
   }
}

</script>
</head>
<body onload="next();">
<div style="margin:auto;width:50%;">
<h1 id="question"></h1>
<br>
<div style="margin:auto;width:50%;">
<button id="yesB" onclick="yes();">Yes</button>
<button id="noB" onclick="next();">No</button>
<textarea id="infobox" style="display:none;"></textarea>
<br>
<label id="output" disabled></label>
</div>
</div>
</body>
</html>
